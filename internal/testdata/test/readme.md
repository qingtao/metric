# 测试多种查询欧几里得距离的执行时间

- 测试环境

```
PC: windows10
cpu: i5-9300H 2.4GHz 4核8线程
memory: 16GB DDR4
```

- 测试过程

1. 每次按参数-num指定的数量生成128个元素的数组
2. 按照暴力遍历、vptree、多核暴力遍历、多核多vptree的方式查询最小值或者距离小于内置值0.162;

- 测试结果

1. 查询1000000条使用的内存大约为2.2GB

```powershell
PS D:\src\qingtao\metric\internal\testdata\test> .\test.exe -num 1000000
```

```
num:  1000000
direct(遍历): 1.3284303s
0.11633694511519418
0.1247082943204828
0.13185370591341156
0.1339387106472411
0.13435557532141165
vptree(生成树时间): 17.6232823s
vptree(查询时间): 568.5704ms
0.11633694511519418
0.1247082943204828
0.13185370591341156
0.1339387106472411
0.13435557532141165
direct(多核cpu遍历): 539.5569ms
0.11633694511519418
0.1247082943204828
0.13185370591341156
0.1339387106472411
0.13435557532141165
vptree(多核cpu生成树的时间): 14.4790557s
vptree(多核cpu查询时间): 127.6505ms
0.11633694511519418
0.1247082943204828
0.13185370591341156
0.1339387106472411
0.13435557532141165
```

2. 查询2000000条使用的内存大约为4.3GB

```powershell
PS D:\src\qingtao\metric\internal\testdata\test> .\test.exe -num 2000000 
```

```
num:  2000000
direct(遍历): 2.8225066s
0.13513374788211407
0.13880886494829509
0.13922693777997727
0.1392647421014109
0.14019952125861979
vptree(生成树时间): 37.3169655s
vptree(查询时间): 1.1481606s
0.13513374788211407
0.13880886494829509
0.13922693777997727
0.1392647421014109
0.14019952125861979
direct(多核cpu遍历): 1.0003251s
0.13513374788211407
0.13880886494829509
0.13922693777997727
0.1392647421014109
0.14019952125861979
vptree(多核cpu生成树的时间): 30.835231s
vptree(多核cpu查询时间): 205.4822ms
0.13513374788211407
0.13880886494829509
0.13922693777997727
0.1392647421014109
0.14019952125861979
```

3. 查询200000条数据时内存大约为500MB

```powershell
PS D:\src\qingtao\metric\internal\testdata\test> .\test.exe -num 200000
```

```
num:  200000
direct(遍历): 259.3071ms
0.14680637692342288
0.15006497462320775
0.15033691724517131
0.1518263392076664
0.15233302717473104
vptree(生成树时间): 3.0448408s
vptree(查询时间): 115.7556ms
0.14680637692342288
0.15006497462320775
0.15033691724517131
0.1518263392076664
0.15233302717473104
direct(多核cpu遍历): 117.685ms
0.14680637692342288
0.15006497462320775
0.15033691724517131
0.1518263392076664
0.15233302717473104
vptree(多核cpu生成树的时间): 2.4431264s
vptree(多核cpu查询时间): 21.9651ms
0.14680637692342288
0.15006497462320775
0.15033691724517131
0.1518263392076664
0.15233302717473104
```

3. 查询100000条数据时内存大约为260MB

```powershell
PS D:\src\qingtao\metric\internal\testdata\test> .\test.exe -num 100000
```

```
num:  100000
direct(遍历): 138.6299ms
0.1568373327401419
0.15805238276271438
0.1611552787172231
0.16476905284052984
0.16625246809637054
vptree(生成树时间): 1.4441253s
vptree(查询时间): 55.8206ms
0.1568373327401419
0.15805238276271438
0.1611552787172231
direct(多核cpu遍历): 61.8356ms
0.1568373327401419
0.15805238276271438
0.1611552787172231
0.16476905284052984
0.16625246809637054
vptree(多核cpu生成树的时间): 1.1392796s
vptree(多核cpu查询时间): 12.9644ms
0.1568373327401419
0.15805238276271438
0.1611552787172231
```